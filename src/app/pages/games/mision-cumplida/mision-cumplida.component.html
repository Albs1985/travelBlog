<div class="divRight">
  <img src="assets/icons/flechaAtras.png" class="animated fadeIn iconoFlecha" routerLink="/games"><a routerLink="/games">{{ 'viaje.volver' | translate}}</a>
</div>
<div class="espacio2"></div>
<div class="container">
  <h1>{{'app.juegoMisionCumplida' | translate}}</h1>
  <img src="assets/images/games/portadaMisionCumplida.jpg" alt="" class="portadaJuego">
  <h3>{{'app.numJugadores' | translate}}: 1-4</h3>
  <h3>{{'app.duracion' | translate}}: 20 min</h3>
  <h3>{{'app.literalEdad' | translate}}: 8+</h3>

  <div class="settings">

    <div class="listaJugadores centerText">
      <label for="jugadores">{{ 'app.jugadores' | translate }}</label>
      <div class="centraChecks">
        <ng-container *ngFor="let jugador of servicioJugadores.viajerosLista">
          <div class="playerCheckbox">
            <input type="checkbox" [disabled]="currentIndexPlayer >= 0" (change)="togglePlayerSelection(jugador)" [checked]="isPlayerSelected(jugador)">
            <a (click)="togglePlayerSelection(jugador)">{{ jugador.nombreCorto }}</a>
          </div>
        </ng-container>
      </div>
    </div>

    <div class="row fotosPerfiles">
      <div *ngFor="let jugador of jugadoresSeleccionados" class="row dobleFotos">
        <figure [ngClass]="{ 'jugadorSeleccionado': jugador.nombreCorto === selectedPlayer }">
          <img src="{{jugador.fotoPerfil}}" alt="{{jugador.nombreCorto}}" class="imagen img-responsive" (click)="seleccionarJugador(jugador.nombreCorto)">
          <figcaption class="centerText">{{jugador.nombreCorto}} </figcaption>
        </figure>
      </div>
    </div>

    <label class="tituloJuego" *ngIf="(this.jugadorInicialNoSeleccionado | async) === true">{{ 'app.selectPlayer' | translate }}</label>

    <label *ngIf="(this.jugadorInicialNoSeleccionado | async) === false" for="selectorDificultad">{{ 'app.dificultad' | translate }}</label>
    <div *ngIf="(this.jugadorInicialNoSeleccionado | async) === false">
      <select id="selectorDificultad" class="selector" (change)="seleccionarDificultad($event)">
        <option class="centerText" value="" disabled selected>{{ 'app.selecciona' | translate}}</option>
        <option class="centerText" *ngFor="let dificultad of dificultades">{{ dificultad }}</option>
      </select>
    </div>
    <button *ngIf="dificultad != 0" class="btnRestart" (click)="restartGame()">{{ 'app.restart' | translate }}</button>
  </div>

  <div *ngIf="dificultad != 0" class="tablero">

    <!-- Cartas de MisiÃ³n -->
    <div class="titulosCartas">
      <label for="">{{ 'app.misiones' | translate }} ({{dificultad}}/{{misiones.length}})</label>
    </div>
    <div class="cartas-mision">
      <div class="carta-mision animated bounceInDown" *ngFor="let carta of mazoMisiones; let i = index"
          [ngClass]="{'misionCumplida': indexMisionCumplida.includes(i)}">
        {{ carta }}
      </div>
    </div>

    <!-- Cartas boca arriba -->
    <div class="titulosCartas">
      <label for="">{{ 'app.misionesCompletadas' | translate }}: ({{indexMisionCumplida.length}}/{{this.mazoMisiones.length}})</label>
    </div>
    <div class="cartas-boca-arriba">
      <div class="carta-boca-arriba animated bounceInUp" *ngFor="let carta of cartasEnMesa; let i = index"
          (click)="seleccionaCartaEnMesa(carta, i)"
          [ngStyle]="{
            'background-color': obtenerColorCarta(carta),
            'background': 'linear-gradient(to bottom left, ' + obtenerColorCarta(carta) + ', '+obtenerGradienteColorCarta(carta)+')'
          }">
          {{ carta.substring(carta.length-1, carta.length) }}
      </div>
    </div>

    <div class="espacio"></div>

    <!-- Cartas de los jugadores -->
    <div class="titulosCartas">
      <label for="">{{ 'app.tusCartas' | translate }} {{selectedPlayer}} ({{cartasJugadorActivo.length}}/{{this.cartasNumeradas.length}})
        <button *ngIf="jugadoresSeleccionados.length > 1" class="btnTurno animated pulseInfinito" (click)="pasaTurno()">{{ 'app.pasaTurno' | translate }}</button>
      </label>
    </div>

    <div *ngIf="(ocultarCartas|async)===false" class="cartas-jugador">
      <div class="carta-jugador" *ngFor="let carta of cartasJugadorActivo; let i = index"
           (click)="seleccionaCartaJugador(carta, i)"
           [ngClass]="{
            'cartaSeleccionada animated pulseInfinito': i === indexCartaJugadorSelec
            }"
           [ngStyle]="{
            'background-color': obtenerColorCarta(carta),
            'background': 'linear-gradient(to bottom left, ' + obtenerColorCarta(carta) + ', '+obtenerGradienteColorCarta(carta)+')'
            }">
          {{ carta.substring(carta.length-1, carta.length) }}
      </div>
    </div>
    <div *ngIf="(ocultarCartas|async)===true" class="temporizador">
      {{crono}}
    </div>

    <!-- Mazo para simular robar las cartas -->
    <div class="cartas-mazo">
      <div class="mazoDeCartas inclinadoIzquierda"></div>
      <div class="mazoDeCartas inclinadoDerecha"></div>
      <div class="mazoDeCartas inclinadoIzquierda2"></div>
      <div class="mazoDeCartas inclinadoDerecha2"></div>
      <div class="mazoDeCartas mazoTop" [ngClass]="{'animated fadeOutUp': (robaCarta | async) === true}">
        <img src="assets/images/games/portadaMisionCumplida.jpg" class="imgCarta">
      </div>
      <label class="numCartasRestantes">{{this.cartasNumeradas.length}}</label>
    </div>
    <!-- <div class="pasaTurno"></div> -->


  </div> <!-- del tablero -->


  <div *ngIf="(finPartida | async) === true" class="overlay">
    <div class="winnerMessage">
      <button class="btnRestart" (click)="startGame()">{{ 'app.restart' | translate }}</button>
      <label class="winnerLabel">{{motivoFinPartida}}</label>
    </div>
  </div>

</div>
